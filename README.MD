# Intro
- 要安装两个东西，V2Ray和Switchyomega。

- v2ray来自ProjectV，一个了不起的项目。v2ray用的vmess协议比shadowsocks要好，是目前最难嗅探的。如果你觉得还不错，请考虑给ProjectV的作者捐杯咖啡。

- 同一份配置可以无限copy使用，你可以给其他朋友用。

- 自己搭的VPN和买的VPN的最大区别在于，前者是有隐私保护的。保护自己的隐私是一件非常重要的事情，它不光和你一个人有关。


# **V2Ray** for Windows
压缩包解压，目录下有4个文件需要关注：

- readme.md

  readme文档，markdown格式的，可以用编辑器打开，或者拖到chrome里面去打开。readme里是软件的使用事项等。

- **config.json**

  配置文件。所有的设置都在这里面了。具体配置方法见V2Ray官网。~~从官网上下载的win程序，好像即使不更改配置文件也能用。应该是作者自己的服务器。~~默认配置已不可用。我发过去的文件已经改成了我自己的服务器。配置其实不复杂，json格式本来就易懂。

- v2ray.exe

  启动程序。配置文件写好以后就可以启动了。会打开一个命令行界面。这是前台程序，关掉这个界面以后V2ray就断掉了。这个一般不常用，常用的是下面这个。

- **wv2ray.exe**

  也是启动程序。只不过是在后台运行的，可以在任务管理器里看到。后台运行是比较常用的方式。

  - **开机自动运行**：
    把这个文件放入windows的启动文件夹里，让它开机自动运行。方法是开始-运行，输入`shell:startup`，进入启动文件夹。给wv2ray.exe创建一个快捷方式，然后把这个快捷方式放进启动文件夹里。

# **Switchyomega** for Chrome/Firefox
  Switchyomega是一个管理代理的浏览器插件，在Chrome和Firefox上都有。建议使用Firefox，它比Chrome的隐私保护更好。这里暂时还是以Chrome为例（Firefox上是一样的用法），这是[Switchyomega的下载地址](https://github.com/FelisCatus/SwitchyOmega/releases)，下载那个.crx文件。

> ### 代理
> 
> 自习课上，你想跟小明传小纸条。但是离得太远，直接扔过去老师会看到。于是你委托坐在中间的小红帮你们俩递小纸条，小红就是代理。
> 
> 自习课上，你想跟小明互传小情书，可是老师禁止早恋，于是你把情书写成了摩斯电码，这样即使老师抓到也不知道你们聊的是什么。这就是加密协议。
> 
> 在国内上网，许多网站的访问被防火长城（GFW）所禁止，于是你委托一个可以正常与之通信的海外IP作为代理，让它帮你传递小纸条。于是，在GFW看来，你只是在跟一个正常的海外IP通信，而不是访问被禁止的网站。进一步，你为了不让GFW看到你跟代理的通信内容，还可以对它加密。
> 
> 比如访问国内网站时就直连，访问google时就走海外代理，这种行为就可以交给Switchyomega来自行判断。

## 要点

网上教程挺多的。这里有两点需要注意：

  - 代理端口是1079，也就是V2Ray监听的端口。协议是socks5。

  - AutoProxy可用网上的列表：
    https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt
    > 来自gfwlist项目，详见其Github页面。

## 安装方法
打开Chrome扩展程序界面（右上角竖排省略号-更多工具-扩展程序），选中“开发者模式”，然后把switchyomega的文件拖进去就行了。

## 设置步骤

  - 在Chrome里进到Switchyomega的“**选项**”中

  - 点击左边栏的“**新建情景模式**”

  - 在弹出的窗口里随便填一个名字，假设为“**V2Ray**”，情景模式选择“**代理服务器**”
    > 情景模式，顾名思义，比如 需要翻墙的情景 和 不需要翻墙的情景。

  - 然后就进入这个情景模式的设置页面了。页面分为“代理服务器”和“不代理的地址列表”上下两部分

  - 在“代理服务器”部分，协议选“**socks5**”，代理服务器填`127.0.0.1`，代理端口填`1079`
    > 这些参数都是为了对应V2Ray的config.json里的配置。
你也可以改成别的端口，打开配置文件，找到1079改成别的数字就行了。注意不要改成系统服务原本就在用的端口。
如果你打算用系统级代理，就在socks5协议上填这个端口。

  - 点左下角的“**应用选项**”按钮

  - 点击左边的“**auto switch**”情景

  - 在“规则列表设置”中选“**Autoproxy**”

  - 把上面的列表网址粘贴到“**规则列表网址**”一栏中

  - “切换规则”中会出现一条“规则列表规则”

  - 在这一条的“情景模式”中选择刚才新建的情景模式（“**V2Ray**”）

  - “默认的情景模式”选择“**直接连接**”；其他几条删掉，没用处

  - 点左下角的“**应用选项**”按钮

## 使用方法
  - 在Chrome中点击Switchyomega图标

  - 选择“**auto switch**”
    > 相当于shadowsocks的PAC模式。原理其实挺简单的，不赘述了。说一下另外几个选项的意思：
    - **直接连接**
      顾名思义就是不走任何代理
    - **系统代理**
      代理设置与系统一致。shadowsocks就是直接设置系统代理，所以就要切换到“系统代理”上。
    - **V2Ray**
      就是刚才新建的情景模式。在这个情景下所有访问请求都直接走代理，相当于shadowsocks的全局模式。一般不要这样干，浪费流量。

# Tor

Tor在国内不能直接访问，也需要代理。你可以把1079端口同时给Tor，socks5协议。

# Q & A

### 突然断掉怎么办？

- 重启试试
- 等一会儿再试
- 自己`tracert`一下，IP在config.json里
- 实在不行再找我。

### V2Ray支持哪些平台？
- Windows
- Linux
- Mac
- Android
- IOS

### 别的平台怎么部署？

- Linux

  参考V2Ray的文档或者你所用发行版的包管理文档

- Android

  安装Actinium或其他类似APP，把config.json导入

- MacOS

  问狗哥,有[GUI端](https://github.com/Cenmrev/V2RayX/releases/tag/v1.4.0)。

# TODO
- Linux平台部署
  - Ubuntu
  - Arch
- 安卓平台部署
- MacOS平台部署
- GUI端用法
- 正向代理的原理解释


---
2017-10-11 22:48:37

2017-10-22 16:35:22

2018-02-12 18:34:40

2018-06-19 01:21:13

2018-07-04 11:13:43

2018-08-12 12:15:13

2019-06-25 23:02:23
